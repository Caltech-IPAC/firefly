<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Project SYSTEM "../../project.dtd">

<Project>
    <Name>resultViewer</Name>
    <Title>Result Viewer</Title>
    <Properties>
        <Param key="footer" value="irsa_ptf_footer.html"/>
        <Param key="helpMenu" value="Help;Help;overviewHelp"/>
    </Properties>

    <SearchGroup>
        <Name>results</Name>
        <Title>Result Viewer</Title>

        <SearchType helpId="none">
            <Name>UploadResultsSearch</Name>
            <Title>Table Upload</Title>
            <Form>
                <FormEventWorker id="fileShower" type="FieldDefVisibilityControl">
                    <Param key="masters" value="resolveProcessor=file"></Param>
                    <Param key="resolveProcessor" value="file"></Param>
                    <Param key="hide" value="urlColumn"></Param>
                    <Param key="show" value="fileColumn"></Param>
                    <Param key="retainSpace" value="true"></Param>
                </FormEventWorker>
                <FormEventWorker id="urlShower" type="FieldDefVisibilityControl">
                    <Param key="masters" value="resolveProcessor=url"></Param>
                    <Param key="hide" value="fileColumn"></Param>
                    <Param key="show" value="urlColumn"></Param>
                    <Param key="retainSpace" value="true"></Param>
                </FormEventWorker>
                <FormEventWorker id="fileURLHider" type="FieldDefVisibilityControl">
                    <Param key="masters" value="or(resolveProcessor=WISE-ATLAS,resolveProcessor=PTF)"></Param>
                    <Param key="hide" value="fileColumn,urlColumn"></Param>
                    <Param key="retainSpace" value="true"></Param>
                </FormEventWorker>
                <FieldGroup align="left" labelWidth="75">
                    <File>
                        <Name>loadTable</Name>
                        <Title>File Name</Title>
                        <Cached/>
                        <Size>100</Size>
                        <ShortDescription>Select a file to upload</ShortDescription>
                        <ErrorDescription>File upload error</ErrorDescription>
                    </File>
                    <EnumString orientation="vertical">
                        <Name>resolveProcessor</Name>
                        <Title>Data Type:</Title>
                        <PreferWidth>100</PreferWidth>
                        <Mask>[RADIO]</Mask>
                        <Default>PTF</Default>
                        <ShortDescription>Type of Data</ShortDescription>
                        <EnumValue id="WISE-ATLAS">
                            <Title>Wise Atlas</Title>
                        </EnumValue>
                        <EnumValue id="PTF">
                            <Title>PTF</Title>
                        </EnumValue>
                        <EnumValue id="file">
                            <Title>File Column</Title>
                        </EnumValue>
                        <EnumValue id="url">
                            <Title>URL Column</Title>
                        </EnumValue>
                    </EnumString>
                    <String>
                        <Name>fileColumn</Name>
                        <Title>File Column</Title>
                        <Default>file</Default>
                    </String>
                    <String>
                        <Name>urlColumn</Name>
                        <Title>URL Column</Title>
                        <Default>url</Default>
                    </String>
                    <HIDDEN>
                        <Name>isUpload</Name>
                        <Default>true</Default>
                    </HIDDEN>
                </FieldGroup>
            </Form>
            <Query id="tableResults" searchProcessorId="resultSearch" >
                <Param key="dummy" value="no-data"/>
                <Param key="WISE-ATLAS" value="wise:wise_1:wiseQuery_3a:WiseFileRetrieve"/>
                <Param key="PTF" value="ptf:ptf_l1:ptfQuery_l1:PtfFileRetrieve"/>
                <Param key="LCOGT" value="lcogt:lcogt:lcogtQuery_l1:LcogtFileRetrieve"/>
                <Metadata>
                    <Param key="ALL_CORNERS"
                           value="ra1;dec1;EQ_J2000,ra2;dec2;EQ_J2000,ra3;dec3;EQ_J2000,ra4;dec4;EQ_J2000"/>
                    <Param key="CENTER_COLUMN" value="crval1;crval2;EQ_J2000"/>
                    <Param key="PREVIEW_COLUMN" value="download"/>
                    <Param key="RESOURCE_TYPE" value="URL"/>
                </Metadata>
                <Download id="resultViewerDownload" title="Options" filePrefix="Files" titlePrefix="Download Files" maxRows="5000">
                    <SearchFormParam keyName="subsize" keyValue="*" createParams="subsize,UserTargetWorldPt"/>
                </Download>
            </Query>
            <Result>
                <Layout>
                    <SplitPanel>
                        <East layout="fixedTab" initialWidth="400">
                            <Preview type="DATA_VIEW" id="prev_l1">
                                <QueryId>tableResults</QueryId>
                                <EventWorkerId>target_l1</EventWorkerId>
                                <Title>L1 Image</Title>
                                <Param key="ArgCols" value="ALL"/>
                                <Param key="ArgHeaders" value="ALL"/>
                                <Param key="Title" value="FITS Image"/>
                                <Param key="ColorTableId" value="1"/>
                                <Param key="PlotGroup" value="RESULT_VIEWER_IMAGES"/>
                                <Param key="LockRelated" value="true"/>
                                <Param key="UseScrollBars" value="false"/>
                                <Param key="RememberPrefs" value="true"/>
                                <Param key="ColorPreferenceKey" value="RVColor"/>
                                <Param key="MinSize" value="100x100"/>
                                <Param key="DV_HAS_DATA_HEADER" value="DataType"/>
                            </Preview>
                        </East>
                        <Center layout="tab" tagIt='true'>
                            <Table type="TABLE">
                                <QueryId>tableResults</QueryId>
                                <Title>Results</Title>
                                <Param key="Title" value="Results"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="RESULT-IMAGES"/>
                            </Table>
                        </Center>
                    </SplitPanel>
                </Layout>
            </Result>
        </SearchType>
    </SearchGroup>

</Project>