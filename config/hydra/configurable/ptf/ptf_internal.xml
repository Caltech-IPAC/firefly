<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Project SYSTEM "../../project.dtd" [
        <!ENTITY few_vis_cntrl        SYSTEM "few_vis_cntrl.xml.txt">
        ]>

<Project>
    <Name>ptf</Name>
    <Title>The Palomar Transient Factory</Title>
    <Properties>
        <Param key="footer" value="irsa_footer.html"/>
        <Param key="smallIcon" value="ptf_logo_left.html"/>
        <Param key="helpMenu" value="Ptf Help;Ptf Help;overviewHelp"/>
    </Properties>

    <SearchGroup>
        <Name>PTF Images</Name>
        <Title>Image Searches</Title>

        <SearchType layoutSelector="true" helpId="basics.searching">
            <Name>ptf_image_pos</Name>
            <Title>Search by Position</Title>
            <Tooltip>Search PTF Image by Position</Tooltip>
            <Form>
                <FormEventWorker id="fdvController_1" type="FieldDefVisibilityControl" xid="fdvController_1">
                    <Param key="masters" value="intersect=CENTER"></Param>
                    <Param key="show" value="subsize,mcenter"></Param>
                    <Param key="hide" value="size"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_2" type="FieldDefVisibilityControl" xid="fdvController_2">
                    <Param key="masters" value="or(intersect=ENCLOSED,intersect=OVERLAPS)"></Param>
                    <Param key="show" value="size"></Param>
                    <Param key="hide" value="subsize,mcenter"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_3" type="FieldDefVisibilityControl" xid="fdvController_3">
                    <Param key="masters" value="intersect=COVERS"></Param>
                    <Param key="show" value="size,subsize,mcenter"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_4" type="FieldDefVisibilityControl" xid="fdvController_4">
                    <Param key="masters" value="frameOp=be"></Param>
                    <Param key="show" value="frameVal1,frameVal2"></Param>
                    <Param key="hide" value="frameVal3"></Param>
                    <Param key="retainSpace" value="false"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_5" type="FieldDefVisibilityControl" xid="fdvController_5">
                    <Param key="masters" value="frameOp=in"></Param>
                    <Param key="show" value="frameVal3"></Param>
                    <Param key="hide" value="frameVal1,frameVal2"></Param>
                    <Param key="retainSpace" value="false"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_6" type="FieldDefVisibilityControl" xid="fdvController_6">
                    <Param key="masters" value="or(frameOp=eq,frameOp=gt,frameOp=lt)"></Param>
                    <Param key="show" value="frameVal1"></Param>
                    <Param key="hide" value="frameVal2,frameVal3"></Param>
                    <Param key="retainSpace" value="false"></Param>
                </FormEventWorker>

                <FieldGroup align="left" labelWidth="300">
                    <FieldGroup type="activeTabPane" typeName="POS UPL TabPane" width="640px" height="106px">
                        <FieldGroup>
                            <Title>Single Object</Title>
                            <PreDefField id="simpleTargetPanel">
                                <Param key="Resolvers" value="NED, Simbad, PTF"/>
                            </PreDefField>
                        </FieldGroup>
                        <FieldGroup labelWidth="70">
                            <Title>Multi-Object</Title>
                            <File>
                                <Name>filename</Name>
                                <Title>File Name</Title>
                                <Cached/>
                                <Size>62</Size>
                                <ShortDescription>Select a file to upload</ShortDescription>
                                <ErrorDescription>File upload error</ErrorDescription>
                            </File>
                            <Help helpId="basics.searching">
                                <Title>Help on file format</Title>
                            </Help>
                        </FieldGroup>
                    </FieldGroup>
                    <Label><![CDATA[&nbsp;]]></Label>
                    <Label>
                        <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp;Example for PTF name resolver: </i>10fqs, 09ab<i></i><br><br>]]>
                    </Label>
                    <FieldGroup align="left" labelWidth="300" xid="regionSearch">
                        <EnumString>
                            <Name>intersect</Name>
                            <Title>Search Type (Region Intersection)</Title>
                            <PreferWidth>150</PreferWidth>
                            <Default>CENTER</Default>
                            <ShortDescription>Search Type (Region Intersection)</ShortDescription>
                            <EnumValue id="CENTER">
                                <Title>Image contains target</Title>
                            </EnumValue>
                            <EnumValue id="COVERS">
                                <Title>Image covers entire search region</Title>
                            </EnumValue>
                            <EnumValue id="ENCLOSED">
                                <Title>Image is entirely enclosed by search region</Title>
                            </EnumValue>
                            <EnumValue id="OVERLAPS">
                                <Title>Any pixel overlaps search region</Title>
                            </EnumValue>
                        </EnumString>
                        <DEGREE units="arcsec">
                            <Name>size</Name>
                            <Title>Search Region (Square) Size</Title>
                            <Default>30</Default>
                            <PreferWidth>16</PreferWidth>
                            <ShortDescription>Enter the region size of the search</ShortDescription>
                            <ErrorDescription>Region size out of range</ErrorDescription>
                            <Min>1</Min>
                            <Max>43200</Max>
                            <Cached/>
                        </DEGREE>
                        <DEGREE units="arcsec">
                            <Name>subsize</Name>
                            <Title>Return Image Size (leave blank for full images)</Title>
                            <Default>500</Default>
                            <PreferWidth>16</PreferWidth>
                            <ShortDescription>Specifies the size of the desired L2 and/or L1 image cutout. Omitting this
                                constraint will result in visualization/return of entire L2/L1 images.

                                In multi-input mode, this takes effect only for input tables without a subsize column.
                            </ShortDescription>
                            <ErrorDescription>Invalid entry!</ErrorDescription>
                            <Min>1</Min>
                            <Max>7200</Max>
                            <NullAllowed/>
                        </DEGREE>
                        <EnumString>
                            <Name>mcenter</Name>
                            <Title>Return only the most centered image containing the target:</Title>
                            <PreferWidth>150</PreferWidth>
                            <Mask>[RADIO]</Mask>
                            <Default>all</Default>
                            <NullAllowed/>
                            <ShortDescription>Specifies whether to return only the most centered (in pixel space)
                                image-set for the given input position.

                                In multi-input mode, this flag applies only for input tables without a best column.
                            </ShortDescription>
                            <EnumValue id="all">
                                <Title>No</Title>
                            </EnumValue>
                            <EnumValue id="mcen">
                                <Title>Yes</Title>
                            </EnumValue>
                        </EnumString>
                        <FieldGroup xid="dpLevel_all" labelWidth="140">
                            <EnumString orientation="horizontal">
                                <ID>dpLevel_all</ID>
                                <Name>dpLevel</Name>
                                <Title>Data Product Level:</Title>
                                <PreferWidth>300</PreferWidth>
                                <Mask>[CHECKBOX]</Mask>
                                <Default>_all_</Default>
                                <ShortDescription>Data Product Level</ShortDescription>
                                <ErrorDescription>Select at least one product!</ErrorDescription>
                                <EnumValue id="l1">
                                    <Title>Processed Image</Title>
                                </EnumValue>
                                <EnumValue id="l2">
                                    <Title>Reference Image</Title>
                                </EnumValue>
                            </EnumString>
                        </FieldGroup>
                        <FieldGroup type="activeCollapsiblePanel" labelWidth="200">
                            <Title>Optional search constraints</Title>
                            <FieldGroup align="left" labelWidth="144">
                                <String>
                                    <Name>ptfField</Name>
                                    <Title>PTF Field ID(s)</Title>
                                    <PreferWidth>50</PreferWidth>
                                    <NullAllowed/>
                                    <ShortDescription>Optionally provide a PTF Field identifier. Example: '100043'
                                    </ShortDescription>
                                </String>
                                <Label>
                                    <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp; Example for multiple Field IDs: </i>100043;4445<br><br>]]>
                                </Label>
                            </FieldGroup>
                            <FieldGroup align="left" labelWidth="144">
                                <String>
                                    <Name>ccdId</Name>
                                    <Title>CCD ID(s)</Title>
                                    <PreferWidth>50</PreferWidth>
                                    <NullAllowed/>
                                    <ShortDescription>Optionally provide ccdid. Example: '8'</ShortDescription>
                                </String>
                                <Label>
                                    <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp;Valid ccdid range from 0 to 11. Example for multiple ccdids: </i>8;9;10<br><br>]]>
                                </Label>
                            </FieldGroup>
                        </FieldGroup>
                    </FieldGroup>
                </FieldGroup>
            </Form>
            <Query id="ptfQuery_l2" searchProcessorId="PtfRefimsQuery" xid="ptfQuery_l2">
                <Constraints>
                    <Condition fieldDefId="dpLevel" value="l2"/>
                </Constraints>
                <Param key="host" value="%ptf.ibe.host%"/>
                <Param key="schemaGroup" value="ptf"/>
                <Param key="schema" value="dev_ims"/>
                <Param key="table" value="ptf_l2_img"/>
                <Param key="ProductLevel" value="l2"/>
                <Param key="SortInfo" value="SortInfo=ASC,ptffield,fid,ccdid"/>
                <Metadata>
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l2_img"/>
                    <Param key="ProductLevel" value="l2"/>
                    <Param key="ALL_CORNERS"
                           value="ra1;dec1;EQ_J2000,ra2;dec2;EQ_J2000,ra3;dec3;EQ_J2000,ra4;dec4;EQ_J2000"/>
                    <Param key="CENTER_COLUMN" value="ra;dec;EQ_J2000"/>
                    <Param key="PREVIEW_COLUMN" value="download"/>
                    <Param key="RESOURCE_TYPE" value="URL"/>
                    <Param key="col.related" value="ccdid"/>
                    <Param key="col.in_row_id.Visibility" value="hide"/>
                    <Param key="col.in_ra.Visibility" value="hide"/>
                    <Param key="col.in_dec.Visibility" value="hide"/>
                    <Param key="col.ra1.Visibility" value="hide"/>
                    <Param key="col.ra2.Visibility" value="hide"/>
                    <Param key="col.ra3.Visibility" value="hide"/>
                    <Param key="col.ra4.Visibility" value="hide"/>
                    <Param key="col.dec1.Visibility" value="hide"/>
                    <Param key="col.dec2.Visibility" value="hide"/>
                    <Param key="col.dec3.Visibility" value="hide"/>
                    <Param key="col.dec4.Visibility" value="hide"/>
                    <Param key="col.ptffiled.SortByCols" value="rfid,ptffield,fid,ccdid"/>
                </Metadata>
                <Download id="PtfRefimsDownload" title="Download Options" filePrefix="PTF_Refims_Files"
                          titlePrefix="PTF" maxRows="5000">
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l2_img"/>
                    <Param key="ProductLevel" value="l2"/>
                    <SearchFormParam keyName="subsize" keyValue="*" createParams="subsize,UserTargetWorldPt"/>
                    <Form>
                        <FieldGroup labelWidth="130">
                            <EnumString orientation="horizontal">
                                <Name>refImage</Name>
                                <Title>Download Reference (Level 2) Images:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[RADIO]</Mask>
                                <Default>yes</Default>
                                <ShortDescription>Download reference images</ShortDescription>
                                <EnumValue id="yes">
                                    <Title>Yes</Title>
                                </EnumValue>
                                <EnumValue id="no">
                                    <Title>No</Title>
                                </EnumValue>
                            </EnumString>
                            <EnumString orientation="horizontal">
                                <Name>anciFiles</Name>
                                <Title>Download Ancillary Files:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[CHECKBOX]</Mask>
                                <Default>_none_</Default>
                                <NullAllowed/>
                                <ShortDescription>Download Ancillary Files</ShortDescription>
                                <EnumValue id="A">
                                    <Title>Ancillary Images</Title>
                                </EnumValue>
                                <EnumValue id="S">
                                    <Title>SExtractor Catalog</Title>
                                </EnumValue>
                                <EnumValue id="P">
                                    <Title>PSF Catalog</Title>
                                </EnumValue>
                            </EnumString>
                            <FieldGroup labelWidth="130" downloadRestriction="subsize=*">
                                <EnumString orientation="vertical">
                                    <Name>dlCutouts</Name>
                                    <Title>Download</Title>
                                    <PreferWidth>400</PreferWidth>
                                    <Default>cut</Default>
                                    <ShortDescription>Download Cutouts Option</ShortDescription>
                                    <EnumValue id="cut">
                                        <Title>Specified Cutouts</Title>
                                    </EnumValue>
                                    <EnumValue id="orig">
                                        <Title>Original Images</Title>
                                    </EnumValue>
                                </EnumString>
                            </FieldGroup>
                            <EnumString orientation="vertical">
                                <Name>zipType</Name>
                                <Title>Zip File Structure</Title>
                                <PreferWidth>400</PreferWidth>
                                <Default>flat</Default>
                                <ShortDescription>Zip File Structure</ShortDescription>
                                <EnumValue id="folder">
                                    <Title>Structured (with folders)</Title>
                                </EnumValue>
                                <EnumValue id="flat">
                                    <Title>Flattened (no folders)</Title>
                                </EnumValue>
                            </EnumString>
                            <Label><![CDATA[&nbsp;]]></Label>
                        </FieldGroup>
                    </Form>
                </Download>
            </Query>
            <Query id="ptfQuery_l1" searchProcessorId="PtfQuery" xid="ptfQuery_l1">
                <Constraints>
                    <Condition fieldDefId="dpLevel" value="l1"/>
                </Constraints>
                <Param key="host" value="%ptf.ibe.host%"/>
                <Param key="schemaGroup" value="ptf"/>
                <Param key="schema" value="dev_ims"/>
                <Param key="table" value="ptf_l1_img"/>
                <Param key="ProductLevel" value="l1"/>
                <Param key="SortInfo" value="SortInfo=ASC,nid,obsdate,ccdid"/>
                <Metadata>
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l1_img"/>
                    <Param key="ProductLevel" value="l1"/>
                    <Param key="ALL_CORNERS"
                           value="ra1;dec1;EQ_J2000,ra2;dec2;EQ_J2000,ra3;dec3;EQ_J2000,ra4;dec4;EQ_J2000"/>
                    <Param key="CENTER_COLUMN" value="crval1;crval2;EQ_J2000"/>
                    <Param key="PREVIEW_COLUMN" value="download"/>
                    <Param key="RESOURCE_TYPE" value="URL"/>
                    <Param key="col.related" value="expid,ccdid"/>
                    <Param key="col.in_row_id.Visibility" value="hide"/>
                    <Param key="col.in_ra.Visibility" value="hide"/>
                    <Param key="col.in_dec.Visibility" value="hide"/>
                    <Param key="col.obsmjd.Visibility" value="hide"/>
                    <Param key="col.ptfprpi.Visibility" value="hide"/>
                    <Param key="col.fieldid.Visibility" value="hide"/>
                    <Param key="col.filtersl.Visibility" value="hide"/>
                    <Param key="col.moonra.Visibility" value="hide"/>
                    <Param key="col.moondec.Visibility" value="hide"/>
                    <Param key="col.moonphas.Visibility" value="hide"/>
                    <Param key="col.moonalt.Visibility" value="hide"/>
                    <Param key="col.moonphas.Visibility" value="hide"/>
                    <Param key="col.gain.Visibility" value="hide"/>
                    <Param key="col.readnoi.Visibility" value="hide"/>
                    <Param key="col.darkcur.Visibility" value="hide"/>
                    <Param key="col.afilename2.Visibility" value="hide"/>
                    <Param key="col.ra1.Visibility" value="hide"/>
                    <Param key="col.ra2.Visibility" value="hide"/>
                    <Param key="col.ra3.Visibility" value="hide"/>
                    <Param key="col.ra4.Visibility" value="hide"/>
                    <Param key="col.dec1.Visibility" value="hide"/>
                    <Param key="col.dec2.Visibility" value="hide"/>
                    <Param key="col.dec3.Visibility" value="hide"/>
                    <Param key="col.dec4.Visibility" value="hide"/>
                    <Param key="col.nid.SortByCols" value="nid,obsdate,ccdid,filter"/>
                    <Param key="col.expid.SortByCols" value="expid,ccdid"/>
                </Metadata>
                <Download id="PtfDownload" title="Download Options" filePrefix="PTF_Procim_Files" titlePrefix="PTF"
                          maxRows="5000">
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l1_img"/>
                    <Param key="ProductLevel" value="l1"/>
                    <SearchFormParam keyName="subsize" keyValue="*" createParams="subsize,UserTargetWorldPt"/>
                    <Form>
                        <FieldGroup labelWidth="130">
                            <EnumString orientation="horizontal">
                                <Name>procImage</Name>
                                <Title>Download Processed (Level 1) Images:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[RADIO]</Mask>
                                <Default>yes</Default>
                                <ShortDescription>Download processed images</ShortDescription>
                                <EnumValue id="yes">
                                    <Title>Yes</Title>
                                </EnumValue>
                                <EnumValue id="no">
                                    <Title>No</Title>
                                </EnumValue>
                            </EnumString>
                            <EnumString orientation="horizontal">
                                <Name>anciFiles</Name>
                                <Title>Download Ancillary Files:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[CHECKBOX]</Mask>
                                <Default>_none_</Default>
                                <NullAllowed/>
                                <ShortDescription>Download Ancillary Files</ShortDescription>
                                <EnumValue id="M">
                                    <Title>Mask</Title>
                                </EnumValue>
                                <EnumValue id="R">
                                    <Title>Raw Images</Title>
                                </EnumValue>
                                <EnumValue id="S">
                                    <Title>SExtractor Catalog</Title>
                                </EnumValue>
                                <EnumValue id="P">
                                    <Title>PSF Catalog</Title>
                                </EnumValue>
                            </EnumString>
                            <FieldGroup labelWidth="130" downloadRestriction="subsize=*">
                                <EnumString orientation="vertical">
                                    <Name>dlCutouts</Name>
                                    <Title>Download</Title>
                                    <PreferWidth>400</PreferWidth>
                                    <Default>cut</Default>
                                    <ShortDescription>Download Cutouts Option</ShortDescription>
                                    <EnumValue id="cut">
                                        <Title>Specified Cutouts</Title>
                                    </EnumValue>
                                    <EnumValue id="orig">
                                        <Title>Original Images</Title>
                                    </EnumValue>
                                </EnumString>
                            </FieldGroup>
                            <EnumString orientation="vertical">
                                <Name>zipType</Name>
                                <Title>Zip File Structure</Title>
                                <PreferWidth>400</PreferWidth>
                                <Default>flat</Default>
                                <ShortDescription>Zip File Structure</ShortDescription>
                                <EnumValue id="folder">
                                    <Title>Structured (with folders)</Title>
                                </EnumValue>
                                <EnumValue id="flat">
                                    <Title>Flattened (no folders)</Title>
                                </EnumValue>
                            </EnumString>
                            <Label><![CDATA[&nbsp;]]></Label>
                        </FieldGroup>
                    </Form>
                </Download>
            </Query>
            <Result xid="ptfResults">
                <EventWorker id="target" type="ActiveTarget">
                    <QueryId>ptfQuery_l2,ptfQuery_l1</QueryId>
                    <Param key="TargetType" value="TableRow"/>
                    <Param key="TargetColumns" value="in_ra,in_dec"/>
                </EventWorker>
                <Layout>
                    <SplitPanel>
                        <East layout="fixedTab" initialWidth="400">
                            <Preview type="DATA_VIEW" id="prev_l2">
                                <Constraints>
                                    <Or>
                                        <Condition fieldDefId="dpLevel" value="l2"/>
                                        <Condition fieldDefId="dpLevel" value="l1"/>
                                    </Or>
                                </Constraints>
                                <QueryId>ptfQuery_l2,ptfQuery_l1</QueryId>
                                <EventWorkerId>target</EventWorkerId>
                                <Title>Image Preview</Title>
                                <Param key="ArgCols"
                                       value="ptffield,fid,ccdid,ppid,version,filename,pfilename,in_ra,in_dec"/>
                                <Param key="searchProcessorId" value="PtfFileRetrieve"/>
                                <Param key="ExtraParams" value="dpLevel"/>
                                <Param key="Title" value="PTF Image"/>
                                <Param key="CenterOnQueryTarget" value="true"/>
                                <Param key="ColorTableId" value="1"/>
                                <!--<Param key="Stretch" value="min%=1,max%=99,Type=Log"/>-->
                                <Param key="Stretch" value="minSigma=-2,maxSigma=10,Type=Linear"/>
                                <!--Param key="Zoom" value=".125"/-->
                                <Param key="Zoom" value="UseMetaTag:usingSubsize:subSizeFalse=.125,subSizeTrue=1"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                                <Param key="LockRelated" value="true"/>
                                <Param key="UseScrollBars" value="false"/>
                                <Param key="RememberPrefs" value="true"/>
                                <Param key="ColorPreferenceKey" value="PtfColor"/>
                                <Param key="LayoutToolbarOver" value="prev_image"/>
                                <Param key="MinSize" value="100x100"/>
                                <Param key="ArgHeaders" value="host,schemaGroup,schema,table,ProductLevel,subsize,"/>
                            </Preview>
                            <Preview type="COVERAGE_VIEW">
                                <QueryId>ptfQuery_l1,ptfQuery_l2</QueryId>
                                <EventWorkerId>target,rowTarget</EventWorkerId>
                                <Title>Coverage</Title>
                            </Preview>
                        </East>
                        <Center layout="tab" tagIt='true'>
                            <Table type="TABLE">
                                <QueryId>ptfQuery_l1</QueryId>
                                <Title>Level 1 Data</Title>
                                <Param key="Title" value="Single ccd Images"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="PTF_L1_IMAGES"/>
                            </Table>
                            <Table type="TABLE">
                                <QueryId>ptfQuery_l2</QueryId>
                                <Title>Level 2 Data</Title>
                                <Param key="Title" value="Reference Images"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="PTF_L2_IMAGES"/>
                            </Table>
                        </Center>
                    </SplitPanel>
                </Layout>
            </Result>
        </SearchType>

        <SearchType layoutSelector="true" helpId="basics.byPTFField">
            <Name>ptf_image_field</Name>
            <Title>Search by PTF Field ID</Title>
            <Tooltip>Search PTF image by field ids</Tooltip>
            <Form>
                <FieldGroup align="left" labelWidth="300">
                    <FieldGroup align="left" labelWidth="144">
                        <String>
                            <Name>ptfField</Name>
                            <Title>PTF Field ID(s)</Title>
                            <PreferWidth>50</PreferWidth>
                            <NullAllowed/>
                            <ShortDescription>Optionally provide a PTF Field identifier. Example: '100043'
                            </ShortDescription>
                        </String>
                        <Label>
                            <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp;<i>Example for multiple Field IDs: </i>100043;4445<br><br>]]>
                        </Label>
                    </FieldGroup>
                    <FieldGroup align="left" labelWidth="144">
                        <String>
                            <Name>ccdId</Name>
                            <Title>CCD ID(s)</Title>
                            <PreferWidth>50</PreferWidth>
                            <NullAllowed/>
                            <ShortDescription>Optionally provide ccdid. Example: '8'</ShortDescription>
                        </String>
                        <Label>
                            <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp;valid ccdids range from 0 to 11. Example for multiple ccdids: </i>8;9;10<br><br>]]>
                        </Label>
                    </FieldGroup>
                    <FieldGroup align="left" xid="dpLevel_all" labelWidth="140">
                        <EnumString orientation="horizontal">
                            <ID>dpLevel_all</ID>
                            <Name>dpLevel</Name>
                            <Title>Data Product Level:</Title>
                            <PreferWidth>300</PreferWidth>
                            <Mask>[CHECKBOX]</Mask>
                            <Default>_all_</Default>
                            <ShortDescription>Data Product Level</ShortDescription>
                            <ErrorDescription>Select at least one product!</ErrorDescription>
                            <EnumValue id="l1">
                                <Title>Processed Image</Title>
                            </EnumValue>
                            <EnumValue id="l2">
                                <Title>Reference Image</Title>
                            </EnumValue>
                        </EnumString>
                    </FieldGroup>
                </FieldGroup>
            </Form>
            <Query id="ptfQuery_field_l2" searchProcessorId="PtfRefimsQuery" ref-xid="ptfQuery_l2">
                <Constraints>
                    <Condition fieldDefId="dpLevel" value="l2"/>
                </Constraints>
                <Param key="host" value="%ptf.ibe.host%"/>
                <Param key="schemaGroup" value="ptf"/>
                <Param key="schema" value="dev_ims"/>
                <Param key="table" value="ptf_l2_img"/>
                <Param key="ProductLevel" value="l2"/>
                <Param key="SortInfo" value="SortInfo=ASC,ptffield,fid,ccdid"/>
                <Metadata>
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l2_img"/>
                    <Param key="ProductLevel" value="l2"/>
                    <Param key="ALL_CORNERS"
                           value="ra1;dec1;EQ_J2000,ra2;dec2;EQ_J2000,ra3;dec3;EQ_J2000,ra4;dec4;EQ_J2000"/>
                    <Param key="CENTER_COLUMN" value="ra;dec;EQ_J2000"/>
                    <Param key="PREVIEW_COLUMN" value="download"/>
                    <Param key="RESOURCE_TYPE" value="URL"/>
                    <Param key="col.related" value="ccdid"/>
                    <Param key="col.in_row_id.Visibility" value="hide"/>
                    <Param key="col.in_ra.Visibility" value="hide"/>
                    <Param key="col.in_dec.Visibility" value="hide"/>
                    <Param key="col.ra1.Visibility" value="hide"/>
                    <Param key="col.ra2.Visibility" value="hide"/>
                    <Param key="col.ra3.Visibility" value="hide"/>
                    <Param key="col.ra4.Visibility" value="hide"/>
                    <Param key="col.dec1.Visibility" value="hide"/>
                    <Param key="col.dec2.Visibility" value="hide"/>
                    <Param key="col.dec3.Visibility" value="hide"/>
                    <Param key="col.dec4.Visibility" value="hide"/>
                    <Param key="col.ptffiled.SortByCols" value="rfid,ptffield,fid,ccdid"/>
                </Metadata>
                <Download id="PtfRefimsDownload" title="Download Options" filePrefix="PTF_Refims_Files"
                          titlePrefix="PTF" maxRows="5000">
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l2_img"/>
                    <Param key="ProductLevel" value="l2"/>
                    <SearchFormParam keyName="subsize" keyValue="*" createParams="subsize,UserTargetWorldPt"/>
                    <Form>
                        <FieldGroup labelWidth="130">
                            <EnumString orientation="horizontal">
                                <Name>refImage</Name>
                                <Title>Download Reference (Level 2) Images:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[RADIO]</Mask>
                                <Default>yes</Default>
                                <ShortDescription>Download reference images</ShortDescription>
                                <EnumValue id="yes">
                                    <Title>Yes</Title>
                                </EnumValue>
                                <EnumValue id="no">
                                    <Title>No</Title>
                                </EnumValue>
                            </EnumString>
                            <EnumString orientation="horizontal">
                                <Name>anciFiles</Name>
                                <Title>Download Ancillary Files:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[CHECKBOX]</Mask>
                                <Default>_none_</Default>
                                <NullAllowed/>
                                <ShortDescription>Download Ancillary Files</ShortDescription>
                                <EnumValue id="A">
                                    <Title>Ancillary Images</Title>
                                </EnumValue>
                                <EnumValue id="S">
                                    <Title>SExtractor Catalog</Title>
                                </EnumValue>
                                <EnumValue id="P">
                                    <Title>PSF Catalog</Title>
                                </EnumValue>
                            </EnumString>
                            <FieldGroup labelWidth="130" downloadRestriction="subsize=*">
                                <EnumString orientation="vertical">
                                    <Name>dlCutouts</Name>
                                    <Title>Download</Title>
                                    <PreferWidth>400</PreferWidth>
                                    <Default>cut</Default>
                                    <ShortDescription>Download Cutouts Option</ShortDescription>
                                    <EnumValue id="cut">
                                        <Title>Specified Cutouts</Title>
                                    </EnumValue>
                                    <EnumValue id="orig">
                                        <Title>Original Images</Title>
                                    </EnumValue>
                                </EnumString>
                            </FieldGroup>
                            <EnumString orientation="vertical">
                                <Name>zipType</Name>
                                <Title>Zip File Structure</Title>
                                <PreferWidth>400</PreferWidth>
                                <Default>flat</Default>
                                <ShortDescription>Zip File Structure</ShortDescription>
                                <EnumValue id="folder">
                                    <Title>Structured (with folders)</Title>
                                </EnumValue>
                                <EnumValue id="flat">
                                    <Title>Flattened (no folders)</Title>
                                </EnumValue>
                            </EnumString>
                            <Label><![CDATA[&nbsp;]]></Label>
                        </FieldGroup>
                    </Form>
                </Download>
            </Query>
            <Query id="ptfQuery_field_l1" searchProcessorId="PtfQuery" ref-xid="ptfQuery_l1">
                <Constraints>
                    <Condition fieldDefId="dpLevel" value="l1"/>
                </Constraints>
            </Query>
            <Result ref-xid="ptfResults">
                <EventWorker id="target" type="ActiveTarget">
                    <QueryId>ptfQuery_filed_l2,ptfQuery_field_l1</QueryId>
                    <Param key="TargetType" value="TableRow"/>
                    <Param key="TargetColumns" value="ra,dec"/>
                </EventWorker>
                <!--
                <EventWorker id="target_field_l1" type="ActiveTarget">
                    <QueryId>ptfQuery_field</QueryId>
                    <Param key="TargetType" value="TableRow"/>
                    <Param key="TargetColumns" value="crval1,crval2"/>
                </EventWorker>
                -->
                <Layout>
                    <SplitPanel>
                        <East layout="fixedTab" initialWidth="295">
                            <Preview type="DATA_VIEW" id="prev_field">
                                <QueryId>ptfQuery_field_l2,ptfQuery_field_l1</QueryId>
                                <EventWorkerId>target</EventWorkerId>
                                <Title>Image Preview</Title>
                                <Param key="ArgCols"
                                       value="ptffield,fid,ccdid,ppid,version,filename,pfilename,ra,dec,crval1,crval2"/>
                                <Param key="searchProcessorId" value="PtfFileRetrieve"/>
                                <Param key="ExtraParams" value=""/>
                                <Param key="Title" value="PTF Image"/>
                                <Param key="CenterOnQueryTarget" value="true"/>
                                <Param key="ColorTableId" value="1"/>
                                <!--<Param key="Stretch" value="min%=1,max%=99,Type=Log"/>-->
                                <Param key="Stretch" value="minSigma=-2,maxSigma=10,Type=Linear"/>
                                <!--Param key="Zoom" value=".125"/-->
                                <Param key="Zoom" value="UseMetaTag:usingSubsize:subSizeFalse=.125,subSizeTrue=1"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                                <Param key="LockRelated" value="true"/>
                                <Param key="UseScrollBars" value="false"/>
                                <Param key="RememberPrefs" value="true"/>
                                <Param key="ColorPreferenceKey" value="PtfColor"/>
                                <Param key="LayoutToolbarOver" value="prev_l2"/>
                                <Param key="MinSize" value="100x100"/>
                                <Param key="ArgHeaders" value="host,schemaGroup,schema,table,ProductLevel,subsize"/>
                            </Preview>
                            <Preview type="COVERAGE_VIEW">
                                <QueryId>ptfQuery_field_l2,ptfQuery_field_l1</QueryId>
                                <EventWorkerId>target,rowTarget</EventWorkerId>
                                <Title>Coverage</Title>
                            </Preview>
                        </East>

                        <Center layout="tab" tagIt='true'>
                            <Table type="TABLE">
                                <QueryId>ptfQuery_field_l1</QueryId>
                                <Title>Level 1 Data</Title>
                                <Param key="Title" value="Single ccd Images"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                            </Table>
                            <Table type="TABLE">
                                <QueryId>ptfQuery_field_l2</QueryId>
                                <Title>Level 2 Data</Title>
                                <Param key="Title" value="Reference Images"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                            </Table>
                        </Center>
                    </SplitPanel>
                </Layout>
            </Result>
        </SearchType>

        <SearchType layoutSelector="true" helpId="basics.bySSO">
            <Name>ptf_most</Name>
            <Title>Solar System Object/Orbit</Title>
            <Tooltip>Solar System Object/Orbit</Tooltip>
            <Form>
                <FormEventWorker id="fdvController_1" type="FieldDefVisibilityControl">
                    <Param key="masters" value="obj_type_3=Asteroid"></Param>
                    <Param key="show" value="semimajor_axis,mean_anomaly"></Param>
                    <Param key="hide" value="perih_dist,perih_time"></Param>
                    <Param key="retainSpace" value="false"></Param>
                </FormEventWorker>
                <FormEventWorker id="fdvController_2" type="FieldDefVisibilityControl">
                    <Param key="masters" value="obj_type_3=Comet"></Param>
                    <Param key="show" value="perih_dist,perih_time"></Param>
                    <Param key="hide" value="semimajor_axis,mean_anomaly"></Param>
                    <Param key="retainSpace" value="false"></Param>
                </FormEventWorker>
                <FormEventWorker id="tpsController_1" type="TabPaneSizeControl">
                    <Param key="tabPaneName" value="MOST TabPane"></Param>
                    <Param key="Object Name" value="width=640px,height=200px"></Param>
                    <Param key="MPC Input" value="width=640px,height=100px"></Param>
                    <Param key="Manual Input" value="width=640px,height=220px"></Param>
                </FormEventWorker>
                <FormEventWorker id="fcController_1" type="FieldChangeControl">
                    <Param key="fieldName" value="obj_type_*"></Param>
                    <Param key="sync" value="true"></Param>
                </FormEventWorker>
                <FieldGroup align="left" labelWidth="90">
                    <FieldGroup type="activeTabPane" typeName="MOST TabPane" width="640px" height="100px">
                        <FieldGroup labelWidth="90">
                            <Title>Object Name</Title>
                            <PreDefField id="naifTargetPanel"/>
                            <HIDDEN>
                                <Name>ephem_step</Name>
                                <Default>0.25</Default>
                            </HIDDEN>
                            <HIDDEN>
                                <Name>search_region_size</Name>
                                <Default>2.0</Default>
                            </HIDDEN>
                        </FieldGroup>

                        <!--<FieldGroup labelWidth="90">-->
                        <!--<Title>Object Name</Title>-->
                        <!--<EnumString>-->
                        <!--<Name>obj_type_1</Name>-->
                        <!--<Title>Object Type</Title>-->
                        <!--<Default>Asteroid</Default>-->
                        <!--<ShortDescription>Object Type</ShortDescription>-->
                        <!--<EnumValue id="Asteroid">-->
                        <!--<Title>Asteroid</Title>-->
                        <!--</EnumValue>-->
                        <!--<EnumValue id="Comet">-->
                        <!--<Title>Comet</Title>-->
                        <!--</EnumValue>-->
                        <!--</EnumString>-->
                        <!--<String>-->
                        <!--<Name>obj_name</Name>-->
                        <!--<Title>Object Name</Title>-->
                        <!--<PreferWidth>24</PreferWidth>-->
                        <!--<Default></Default>-->
                        <!--<ShortDescription>For asteroid, please use name or designation.-->
                        <!--e.g. Alinda, Eros, Victoria, 1978 UA7, 1999 HF, 2005 AB40-->
                        <!--For comet, please use unique ID part of the name.-->
                        <!--e.g. 1P, 6P, 166P, 1902 G1, 2010 F4-->
                        <!--</ShortDescription>-->
                        <!--<ErrorDescription>Object Name is required!</ErrorDescription>-->
                        <!--</String>-->
                        <!--<String>-->
                        <!--<Name>ephem_step</Name>-->
                        <!--<Title>Ephemeris Step Size (day)</Title>-->
                        <!--<PreferWidth>24</PreferWidth>-->
                        <!--<Default>0.25</Default>-->
                        <!--<ShortDescription>Ephemeris Step Size (day</ShortDescription>-->
                        <!--<ErrorDescription></ErrorDescription>-->
                        <!--</String>-->
                        <!--<String>-->
                        <!--<Name>search_region_size</Name>-->
                        <!--<Title>Search Region Size (deg)</Title>-->
                        <!--<PreferWidth>24</PreferWidth>-->
                        <!--<Default>2.0</Default>-->
                        <!--<ShortDescription>Search Region Size (deg)</ShortDescription>-->
                        <!--<ErrorDescription></ErrorDescription>-->
                        <!--</String>-->
                        <!--</FieldGroup>-->
                        <FieldGroup labelWidth="90">
                            <Title>MPC Input</Title>
                            <EnumString>
                                <Name>obj_type_2</Name>
                                <Title>Object Type</Title>
                                <Default>Asteroid</Default>
                                <ShortDescription>Object Type</ShortDescription>
                                <EnumValue id="Asteroid">
                                    <Title>Asteroid</Title>
                                </EnumValue>
                                <EnumValue id="Comet">
                                    <Title>Comet</Title>
                                </EnumValue>
                            </EnumString>
                            <String>
                                <Name>mpc_data</Name>
                                <Title>MPC 1-Line Input</Title>
                                <PreferWidth>90</PreferWidth>
                                <Default></Default>
                                <ShortDescription>MPC 1-Line Input:
                                    ASTEROID example:
                                    01566 16.9 0.15 K1128 78.13687 31.35339 88.02734 22.82772 0.8268277 0.88069351
                                    1.0779191
                                    COMET example:
                                    CK10A040 2010 10 8.7896 2.738033 0.990439 271.6989 346.6856 96.7301 20110208 12.5
                                    4.0 C/2010 A4
                                </ShortDescription>
                                <ErrorDescription>MPC Input is required!</ErrorDescription>
                            </String>
                        </FieldGroup>
                        <FieldGroup labelWidth="90">
                            <Title>Manual Input</Title>
                            <EnumString>
                                <Name>obj_type_3</Name>
                                <Title>Object Type</Title>
                                <Default>Asteroid</Default>
                                <ShortDescription>Object Type</ShortDescription>
                                <EnumValue id="Asteroid">
                                    <Title>Asteroid</Title>
                                </EnumValue>
                                <EnumValue id="Comet">
                                    <Title>Comet</Title>
                                </EnumValue>
                            </EnumString>
                            <FieldGroup direction="horizontal">
                                <FieldGroup labelWidth="140">
                                    <String>
                                        <Name>body_designation</Name>
                                        <Title>Object Designation</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Object Designation: e.g. 1978 UA7, 1999 HF, 2005 AB40...
                                        </ShortDescription>
                                        <ErrorDescription>Object Designation is required!</ErrorDescription>
                                    </String>
                                    <String>
                                        <Name>epoch</Name>
                                        <Title>Epoch (MJD)</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Epoch (MJD): e.g. 55400, 55231...</ShortDescription>
                                        <ErrorDescription>Epoch is required!</ErrorDescription>
                                    </String>
                                    <String>
                                        <Name>semimajor_axis</Name>
                                        <Title>Semi-major Axis (AU)</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Semi-major Axis (AU): e.g. 2.3230815</ShortDescription>
                                        <ErrorDescription>Semi-major Axis is required!</ErrorDescription>
                                    </String>
                                    <String>
                                        <Name>eccentricity</Name>
                                        <Title>Eccentricity</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Eccentricity: e.g. 0.19304450, 0.99058863...
                                        </ShortDescription>
                                        <ErrorDescription>Eccentricity is required!</ErrorDescription>
                                    </String>
                                    <String>
                                        <Name>perih_dist</Name>
                                        <Title>Perihelion Distance (AU)</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Perihelion Distance (AU): e.g. 2.73792924</ShortDescription>
                                        <ErrorDescription>Perihelion Distance is required!</ErrorDescription>
                                    </String>
                                    <String>
                                        <Name>perih_time</Name>
                                        <Title>Perihelion Time (JD)</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Perihelion Time (JD): e.g. 20101008.73675</ShortDescription>
                                        <ErrorDescription>Perihelion Time is required!</ErrorDescription>
                                    </String>
                                    <Label><![CDATA[<div style='height:300px;'></div>]]></Label>
                                </FieldGroup>
                                <FieldGroup labelWidth="140">
                                    <DEGREE units="degree">
                                        <Name>inclination</Name>
                                        <Title>Inclination</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Inclination: e.g. 24.16475, 96.72800...</ShortDescription>
                                        <ErrorDescription>Inclination is required!</ErrorDescription>
                                        <Min>0</Min>
                                        <Max>180</Max>
                                    </DEGREE>
                                    <DEGREE units="degree">
                                        <Name>arg_perihelion</Name>
                                        <Title>Argument of Perihelion</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Argument of Perihelion: e.g. 2.24303, 271.68529...
                                        </ShortDescription>
                                        <ErrorDescription>Argument of Perihelion is required!</ErrorDescription>
                                        <Min>0</Min>
                                        <Max>360</Max>
                                    </DEGREE>
                                    <DEGREE units="degree">
                                        <Name>ascend_node</Name>
                                        <Title>Ascending Node</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Ascending Node: e.g. 182.36657, 271.68529...
                                        </ShortDescription>
                                        <ErrorDescription>Ascending Node is required!</ErrorDescription>
                                        <Min>0</Min>
                                        <Max>360</Max>
                                    </DEGREE>
                                    <DEGREE units="degree">
                                        <Name>mean_anomaly</Name>
                                        <Title>Mean Anomaly</Title>
                                        <PreferWidth>16</PreferWidth>
                                        <ShortDescription>Mean Anomaly: e.g. 95.8228800, 346.68397...</ShortDescription>
                                        <ErrorDescription>Mean Anomaly is required!</ErrorDescription>
                                        <Min>0</Min>
                                        <Max>360</Max>
                                    </DEGREE>
                                    <Label><![CDATA[<div style='height:300px;'></div>]]></Label>
                                </FieldGroup>
                            </FieldGroup>
                        </FieldGroup>
                    </FieldGroup>
                    <Label><![CDATA[&nbsp;]]></Label>
                    <FieldGroup labelWidth="580">
                        <FieldGroup direction="horizontal" labelWidth="130">
                            <Date>
                                <Name>obs_begin</Name>
                                <Title>Observation Begin (UT)</Title>
                                <Default>2010-01-01</Default>
                                <Format>yyyy-MM-dd;yyyy-MM-dd HH:mm:ss</Format>
                                <NullAllowed/>
                                <ShortDescription>Observation start (yyyy-MM-dd [HH:mm:ss])</ShortDescription>
                                <ErrorDescription>Format error! Use yyyy-MM-dd [HH:mm:ss]</ErrorDescription>
                            </Date>
                            <Date>
                                <Name>obs_end</Name>
                                <Title>Observation End (UT)</Title>
                                <Default>2011-01-01</Default>
                                <Format>yyyy-MM-dd;yyyy-MM-dd HH:mm:ss</Format>
                                <NullAllowed/>
                                <ShortDescription>Observation end (yyyy-MM-dd [HH:mm:ss])</ShortDescription>
                                <ErrorDescription>Format error! Use yyyy-MM-dd [HH:mm:ss]</ErrorDescription>
                            </Date>
                        </FieldGroup>
                        <Label>
                            <![CDATA[<i>&nbsp;&nbsp;&nbsp;&nbsp;Enter date range to search, format example: </i>2010-01-14 15:30:00<i>, or </i>2010-01-14<i>.</i><br><br>]]></Label>
                    </FieldGroup>
                </FieldGroup>
                <FieldGroup align="left" labelWidth="240">
                    <DEGREE units="arcsec">
                        <Name>subsize</Name>
                        <Title>Return Image Size (leave blank for full images)</Title>
                        <Default>500</Default>
                        <PreferWidth>16</PreferWidth>
                        <ShortDescription>Specifies the size of the desired L1 image cutout. Omitting this constraint
                            will result in visualization/return of entire L1 images.

                            In multi-input mode, this takes effect only for input tables without a subsize column.
                        </ShortDescription>
                        <ErrorDescription>Invalid entry!</ErrorDescription>
                        <Min>1</Min>
                        <Max>7200</Max>
                        <NullAllowed/>
                    </DEGREE>
                </FieldGroup>
            </Form>
            <Query id="ptfMOSQuery" searchProcessorId="PtfMOSQuery">
                <Param key="url" value="%ptf.most.host%"/>
                <Param key="ProductLevel" value="l1"/>
                <Param key="catalog" value="ptf"/>
                <Metadata>
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l1_img"/>
                    <Param key="ProductLevel" value="l1"/>
                    <Param key="ALL_CORNERS"
                           value="ra1;dec1;EQ_J2000,ra2;dec2;EQ_J2000,ra3;dec3;EQ_J2000,ra4;dec4;EQ_J2000"/>
                    <Param key="CENTER_COLUMN" value="ra_obj;dec_obj;EQ_J2000"/>
                    <Param key="PREVIEW_COLUMN" value="download"/>
                    <Param key="RESOURCE_TYPE" value="URL"/>
                    <Param key="col.related" value="expid,ccdid"/>
                    <Param key="col.ra1.Visibility" value="hide"/>
                    <Param key="col.ra2.Visibility" value="hide"/>
                    <Param key="col.ra3.Visibility" value="hide"/>
                    <Param key="col.ra4.Visibility" value="hide"/>
                    <Param key="col.dec1.Visibility" value="hide"/>
                    <Param key="col.dec2.Visibility" value="hide"/>
                    <Param key="col.dec3.Visibility" value="hide"/>
                    <Param key="col.dec4.Visibility" value="hide"/>
                    <Param key="col.nid.SortByCols" value="nid,ccdid"/>
                    <Param key="col.expid.SortByCols" value="expid,ccdid"/>
                </Metadata>
                <Download id="PtfDownload" title="Download Options" filePrefix="PTF_MOSqry_Files" titlePrefix="PTF"
                          maxRows="5000">
                    <Param key="host" value="%ptf.ibe.host%"/>
                    <Param key="schemaGroup" value="ptf"/>
                    <Param key="schema" value="dev_ims"/>
                    <Param key="table" value="ptf_l1_img"/>
                    <Param key="ProductLevel" value="l1"/>
                    <SearchFormParam keyName="subsize" keyValue="*" createParams="subsize,UserTargetWorldPt"/>
                    <Form>
                        <FieldGroup labelWidth="130">
                            <EnumString orientation="horizontal">
                                <Name>procImage</Name>
                                <Title>Download Proc Images:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[RADIO]</Mask>
                                <Default>yes</Default>
                                <ShortDescription>Download processed images</ShortDescription>
                                <EnumValue id="yes">
                                    <Title>Yes</Title>
                                </EnumValue>
                                <EnumValue id="no">
                                    <Title>No</Title>
                                </EnumValue>
                            </EnumString>
                            <EnumString orientation="horizontal">
                                <Name>anciFiles</Name>
                                <Title>Download Ancillary Files:</Title>
                                <PreferWidth>400</PreferWidth>
                                <Mask>[CHECKBOX]</Mask>
                                <Default>_none_</Default>
                                <NullAllowed/>
                                <ShortDescription>Download Ancillary Files</ShortDescription>
                                <EnumValue id="M">
                                    <Title>Mask</Title>
                                </EnumValue>
                                <EnumValue id="R">
                                    <Title>Raw Images</Title>
                                </EnumValue>
                                <EnumValue id="S">
                                    <Title>SExtractor Catalog</Title>
                                </EnumValue>
                                <EnumValue id="P">
                                    <Title>PSF Catalog</Title>
                                </EnumValue>
                            </EnumString>
                            <EnumString orientation="vertical">
                                <Name>zipType</Name>
                                <Title>Zip File Structure</Title>
                                <PreferWidth>400</PreferWidth>
                                <Default>flat</Default>
                                <ShortDescription>Zip File Structure</ShortDescription>
                                <EnumValue id="folder">
                                    <Title>Structured (with folders)</Title>
                                </EnumValue>
                                <EnumValue id="flat">
                                    <Title>Flattened (no folders)</Title>
                                </EnumValue>
                            </EnumString>
                            <Label><![CDATA[&nbsp;]]></Label>
                        </FieldGroup>
                    </Form>
                </Download>
            </Query>
            <Result xid="ptfResults">
                <EventWorker id="target_mos" type="ActiveTarget">
                    <QueryId>ptfMOSQuery</QueryId>
                    <Param key="TargetType" value="TableRow"/>
                    <Param key="TargetColumns" value="ra_obj,dec_obj"/>
                </EventWorker>
                <Layout>
                    <SplitPanel>
                        <East layout="fixedTab" initialWidth="500">
                            <Preview type="DATA_VIEW" id="prev_field">
                                <QueryId>ptfMOSQuery</QueryId>
                                <EventWorkerId>target_mos</EventWorkerId>
                                <Title>SSO Image</Title>
                                <Param key="ArgCols" value="pfilename,ra_obj,dec_obj"/>
                                <Param key="searchProcessorId" value="PtfProcimsFileRetrieve"/>
                                <Param key="ExtraParams" value=""/>
                                <Param key="Title" value="PTF Level 1 Image"/>
                                <Param key="CenterOnQueryTarget" value="true"/>
                                <Param key="ColorTableId" value="1"/>
                                <Param key="Stretch" value="minSigma=-2,maxSigma=10,Type=Linear"/>
                                <Param key="Zoom" value="UseMetaTag:usingSubsize:subSizeFalse=.125,subSizeTrue=1"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                                <Param key="LockRelated" value="true"/>
                                <Param key="UseScrollBars" value="false"/>
                                <Param key="RememberPrefs" value="true"/>
                                <Param key="ColorPreferenceKey" value="PtfColor"/>
                                <Param key="LayoutToolbarOver" value="prev_field"/>
                                <Param key="MinSize" value="100x100"/>
                                <Param key="ArgHeaders" value="host,schemaGroup,schema,table,subsize"/>
                            </Preview>
                            <Preview type="COVERAGE_VIEW">
                                <QueryId>ptfMOSQuery</QueryId>
                                <EventWorkerId>target_mos</EventWorkerId>
                                <Title>Coverage</Title>
                                <Param key="PREVIEW_COLUMN" value="pfilename,ra_obj,dec_obj"/>
                                <Param key="RESOURCE_TYPE" value="URL"/>
                            </Preview>
                        </East>
                        <Center layout="tab" tagIt='true'>
                            <Table type="TABLE">
                                <QueryId>ptfMOSQuery</QueryId>
                                <Title>SSO Search Result</Title>
                                <Param key="Title" value="SSO Search Result"/>
                                <Param key="DL_ID" value="processorIdForDownloading"/>
                                <Param key="DL_TITLE_PREFIX" value="auto"/>
                                <Param key="DL_FILE_PREFIX" value="auto"/>
                                <Param key="PlotGroup" value="PTF_IMAGES"/>
                            </Table>
                        </Center>
                    </SplitPanel>
                </Layout>
            </Result>
        </SearchType>

        <SearchType>
            <Name>ptf_view</Name>
            <Title>View up-to-date IRSA PTF Ingestion Status</Title>
            <Tooltip>View PTF ingestion status page</Tooltip>
            <Form>
                <FieldGroup align="left">
                    <Label>
                        <![CDATA[View up-to-date IRSA <a target=_blank href='http://kanaloa.ipac.caltech.edu/applications/Ptf/status.html'>PTF Ingestion Status </a>]]>
                    </Label>
                </FieldGroup>
            </Form>
        </SearchType>
    </SearchGroup>

</Project>